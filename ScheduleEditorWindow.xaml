<Window x:Class="RevitScheduleEditor.ScheduleEditorWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:dgx="urn:tom-englert.de/DataGridExtensions"
        Title="Revit Schedule Editor" Height="700" Width="1000"
        WindowStartupLocation="CenterScreen">

    <Window.Resources>
        <Style TargetType="DataGridCell">
            <Setter Property="BorderBrush" Value="#D6D6D6"/>
            <Setter Property="BorderThickness" Value="0,0,1,1"/>
            <Setter Property="FocusVisualStyle" Value="{x:Null}"/>
        </Style>
        <Style TargetType="DataGridRowHeader">
            <Setter Property="Background" Value="#F0F0F0"/>
            <Setter Property="BorderBrush" Value="DarkGray"/>
            <Setter Property="BorderThickness" Value="0,0,1,1"/>
        </Style>
        
        <Style x:Key="CustomColumnHeaderStyle" TargetType="DataGridColumnHeader">
            <Setter Property="VerticalContentAlignment" Value="Center"/>
            <Setter Property="Background" Value="#F0F0F0"/>
            <Setter Property="BorderBrush" Value="DarkGray"/>
            <Setter Property="BorderThickness" Value="0,0,1,1"/>
            <Setter Property="Padding" Value="5,2"/>
            <Setter Property="ContentTemplate">
                <Setter.Value>
                    <DataTemplate>
                        <StackPanel HorizontalAlignment="Center">
                            <TextBlock Text="{Binding}" FontWeight="Bold"/>
                            <TextBlock Text="{Binding Path=Tag.ParameterType, RelativeSource={RelativeSource AncestorType=DataGridColumnHeader}}" 
                                       Foreground="Gray" FontSize="10"/>
                            <TextBlock Text="{Binding Path=Tag.ParameterGroup, RelativeSource={RelativeSource AncestorType=DataGridColumnHeader}}" 
                                       Foreground="Gray" FontSize="10"/>
                        </StackPanel>
                    </DataTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </Window.Resources>

    <Grid Margin="15">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/> <!-- THÊM HÀNG MỚI CHO CÁC Ô FILTER -->
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,10">
            <Label Content="Select Schedule:" VerticalAlignment="Center" FontWeight="SemiBold"/>
            <ComboBox x:Name="ScheduleComboBox" Width="350" DisplayMemberPath="Name"
                      ItemsSource="{Binding Schedules}"
                      SelectedItem="{Binding SelectedSchedule, Mode=TwoWay}"/>
            <TextBlock Text="Search:" VerticalAlignment="Center" Margin="10,0,5,0"/>
            <TextBox Width="200" VerticalAlignment="Center"
                     Text="{Binding SearchText, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
        </StackPanel>

        <!-- HÀNG MỚI: CHỖ CHỨA CÁC Ô FILTER -->
        <ScrollViewer Grid.Row="1" HorizontalScrollBarVisibility="Auto" VerticalScrollBarVisibility="Disabled">
            <StackPanel x:Name="FilterPanel" Orientation="Horizontal" Margin="0,0,0,5"/>
        </ScrollViewer>

                <DataGrid Grid.Row="2" x:Name="ScheduleDataGrid"
                    AutoGenerateColumns="False"
                    CanUserAddRows="False"
                    HeadersVisibility="Column"
                    CanUserResizeColumns="True"
                    CanUserSortColumns="True"
                    ItemsSource="{Binding ScheduleData}"
                    LoadingRow="ScheduleDataGrid_LoadingRow"
                    SelectionUnit="CellOrRowHeader">
                    <DataGrid.InputBindings>
                        <KeyBinding Key="D" Modifiers="Control" Command="{Binding AutofillCommand}" CommandParameter="{Binding RelativeSource={RelativeSource AncestorType=DataGrid}, Path=SelectedCells}"/>
                    </DataGrid.InputBindings>
                </DataGrid>

    <StackPanel Grid.Row="3" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,10,0,0">
        <Button Content="Update Model" Width="120" Height="30" FontWeight="SemiBold"
            Command="{Binding UpdateModelCommand}"/>
    </StackPanel>
    </Grid>
</Window>