<Window x:Class="RevitScheduleEditor.ScheduleEditorWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:dgx="urn:tom-englert.de/DataGridExtensions"
        Title="Revit Schedule Editor" Height="700" Width="1000"
        WindowStartupLocation="CenterScreen">

    <Window.Resources>
        <!-- Style cho từng ô để có đường viền giống Excel -->
        <Style TargetType="DataGridCell">
            <Setter Property="BorderBrush" Value="#D6D6D6"/>
            <Setter Property="BorderThickness" Value="0,0,1,1"/>
            <Setter Property="FocusVisualStyle" Value="{x:Null}"/>
        </Style>
        <!-- Style cho header dòng (1, 2, 3...) -->
        <Style TargetType="DataGridRowHeader">
            <Setter Property="Background" Value="#F0F0F0"/>
            <Setter Property="BorderBrush" Value="DarkGray"/>
            <Setter Property="BorderThickness" Value="0,0,1,1"/>
        </Style>
        
        <!-- Style header cột đa cấp, cho phép binding dữ liệu từ Tag -->
        <Style x:Key="CustomColumnHeaderStyle" TargetType="DataGridColumnHeader">
            <Setter Property="VerticalContentAlignment" Value="Center"/>
            <Setter Property="Background" Value="#F0F0F0"/>
            <Setter Property="BorderBrush" Value="DarkGray"/>
            <Setter Property="BorderThickness" Value="0,0,1,1"/>
            <Setter Property="Padding" Value="5,2"/>
            <Setter Property="ContentTemplate">
                <Setter.Value>
                    <DataTemplate>
                        <StackPanel HorizontalAlignment="Center">
                            <TextBlock Text="{Binding}" FontWeight="Bold"/>
                            <TextBlock Text="{Binding Path=Tag.ParameterType, RelativeSource={RelativeSource AncestorType=DataGridColumnHeader}}" 
                                       Foreground="Gray" FontSize="10"/>
                            <TextBlock Text="{Binding Path=Tag.ParameterGroup, RelativeSource={RelativeSource AncestorType=DataGridColumnHeader}}" 
                                       Foreground="Gray" FontSize="10"/>
                        </StackPanel>
                    </DataTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </Window.Resources>

    <Grid Margin="15">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,10">
            <Label Content="Select Schedule:" VerticalAlignment="Center" FontWeight="SemiBold"/>
            <ComboBox x:Name="ScheduleComboBox" Width="350" DisplayMemberPath="Name"
                      SelectionChanged="ScheduleComboBox_SelectionChanged"/>
            <Button Content="Preview/Edit" Width="100" Margin="10,0,0,0" Click="PreviewEdit_Click" />
        </StackPanel>

        <DataGrid Grid.Row="1" x:Name="ScheduleDataGrid"
                  AutoGenerateColumns="False" 
                  CanUserAddRows="False"
                  HeadersVisibility="All"
                  GridLinesVisibility="All"
                  HorizontalGridLinesBrush="#D6D6D6"
                  VerticalGridLinesBrush="#D6D6D6"
                  SelectionUnit="CellOrRowHeader"
                  SelectionMode="Extended"
                  ClipboardCopyMode="IncludeHeader"
                  LoadingRow="ScheduleDataGrid_LoadingRow"
                  PreviewKeyDown="ScheduleDataGrid_PreviewKeyDown"/>

        <StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,10,0,0">
            <Button Content="Update Model" Width="120" Height="30" Click="UpdateModel_Click" FontWeight="SemiBold"/>
        </StackPanel>
    </Grid>
</Window>